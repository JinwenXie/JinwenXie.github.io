"use strict";var main=window.main||{};main.mapShareKey="map-shares",main.ga=window.ga||function(){},main=function(e,a){var t=a.Mousetrap;return((window.gitter={}).chat={}).options={disableDefaultChat:!0},e.chat={},e.chat.isOpen=!1,e.chat.createHelpChat=function(){throw new Error("Sidecar chat has not initialized")},document.addEventListener("gitter-sidecar-ready",function(a){function n(){e.chat.isOpen||e.chat.mainChat.toggleChat(!0)}function i(){$("#chat-embed-main").addClass("is-collapsed"),document.activeElement.blur()}function o(){var e=$("#chat-embed-main").hasClass("is-collapsed");e?n():i()}e.chat.GitterChat=a.detail.Chat,e.chat.createHelpChat=function(a,t,n){n=a.replace(/([A-Z])/g," $1").replace("Java Script","JavaScript"),$("body").append('<aside id="chat-embed-help" class="gitter-chat-embed is-collapsed" />'),e.chat.helpChat=new e.chat.GitterChat({room:"freecodecamp/"+a,activationElement:!1,targetElement:$("#chat-embed-help")}),$(t).on("click",function(){var a=!$(this).hasClass("active");e.chat.helpChat.toggleChat(a),a&&$(t).addClass("active")});var i=!1;$("#chat-embed-help").on("gitter-chat-toggle",function(e){var a=!!e.originalEvent.detail.state;return i||(i=!0,$("#chat-embed-help > .gitter-chat-embed-action-bar").prepend('<div class="chat-embed-main-title"><span>'+n+"</span></div>")),a?$(t).addClass("active"):$(t).removeClass("active")})},$("body").append('<aside id="chat-embed-main" class="gitter-chat-embed is-collapsed" />'),e.chat.mainChat=new e.chat.GitterChat({room:"freecodecamp/chinese",activationElement:!1,targetElement:$("#chat-embed-main")});var s=!1;$("#chat-embed-main").on("gitter-chat-toggle",function(){return s?null:(s=!0,$("#chat-embed-main > .gitter-chat-embed-action-bar").prepend('<div class="chat-embed-main-title"><span>Free Code Camp\'s Main Chat</span></div>'),null)}),$("#nav-chat-btn").on("click",o),t.bind("g c",o)}),e}(main,window);var lastCompleted="undefined"!=typeof lastCompleted?lastCompleted:"";main.getMapShares=function(){var e=JSON.parse(localStorage.getItem(main.mapShareKey)||"[]");return e&&Array.isArray(e)||(localStorage.setItem(main.mapShareKey,JSON.stringify([])),e=[]),e},main.setMapShare=function(e){var a=main.getMapShares(),t=!1;return a.forEach(function(a){a===e&&(t=!0)}),t||a.push(e),localStorage.setItem(main.mapShareKey,JSON.stringify(a)),a},$(document).ready(function(){function e(a){a.preventDefault();for(var t=this,n=t.id,i=$(t).data().upVotes,o="undefined"!=typeof o?o:"",s=!1,c=0;c<i.length;c++)if(i[c].upVotedBy===o){s=!0;break}s||$.post("/stories/upvote",{id:n}).fail(function(){$(t).bind("click",e)}).done(function(e){$(t).text("Upvoted!").addClass("disabled"),$("#storyRank").text(e.rank+" points")})}function a(e){$(e).prev().find(".fa-caret-right").removeClass("fa-caret-right").addClass("fa-caret-down")}function t(e){$(e).prev().find(".fa-caret-down").removeClass("fa-caret-down").addClass("fa-caret-right")}function n(e){$(e).addClass("in").css("height","auto"),a(e)}function i(e){$(e).removeClass("in").css("height","auto"),t(e)}function o(){if(!main.isMapAsideLoad){var e=$("<iframe>");e.attr({src:"/map-aside",frameBorder:"0"}),$(".map-aside").append(e),main.isMapAsideLoad=!0}$(".map-aside").removeClass("is-collapsed")}function s(){$(".map-aside").addClass("is-collapsed"),document.activeElement.blur()}function c(){var e=$(".map-aside").hasClass("is-collapsed");e?o():s()}function d(){if(!main.isWikiAsideLoad){var e=window.location.toString().match(/\/\w{2}\//);e=e?e[0]:"/en/";var a="//freecodecamp.github.io/wiki"+e,t=$("<iframe>");t.attr({src:a,frameBorder:"0"}),$(".wiki-aside").append(t),main.isWikiAsideLoad=!0}$(".wiki-aside").removeClass("is-collapsed")}function r(){$(".wiki-aside").addClass("is-collapsed"),document.activeElement.blur()}function l(){var e=$(".wiki-aside").hasClass("is-collapsed");e?d():r()}function h(){b.val(""),b.next().children().removeClass("fa-times").addClass("fa-search"),b.next().removeClass("filled"),$(".map-accordion").find(".hidden").removeClass("hidden"),$("#noneFound").hide()}var p="X-CSRF-Token",m=function(e){jQuery.ajaxPrefilter(function(a,t,n){n.crossDomain||n.setRequestHeader(p,e)})};m($('meta[name="csrf-token"]').attr("content")),$("img").error(function(){$(this).unbind("error").attr("src","/images/camper-image-placeholder.png")}),$("#story-list").on("click","button.btn-upvote",e);var f=function y(){if(!$("#story-submission-form")[0].checkValidity())return null;var e=$("#story-url").val(),a=$("#story-title").val(),t=$("#description-box").val(),n={data:{link:e,headline:a,timePosted:Date.now(),description:t,storyMetaDescription:main.storyMetaDescription,rank:1,image:main.storyImage}};return $("#story-submit").unbind("click"),$.post("/stories/",n).fail(function(){$("#story-submit").bind("click",y)}).done(function(e){var a=e.storyLink,t=e.isBanned;return t?(window.location="/news",null):(window.location="/stories/"+a,null)})};$("#story-submit").on("click",f);var u=main.getMapShares();lastCompleted&&-1===u.indexOf(lastCompleted)&&$('div[id="'+lastCompleted+'"]').parent().parent().removeClass("hidden"),$(".map-challenge-block-share").on("click",function(e){e.preventDefault();var a=$(this).children().attr("id"),t=a.replace(/\s/,"%20"),n="undefined"!=typeof window.username?window.username:"",i="https://www.facebook.com/dialog/feed?app_id=1644598365767721&display=page&caption=I%20just%20completed%20the%20"+t+"%20section%20on%20Free%20Code%20Camp%2E&link=http%3A%2F%2Ffreecodecamp%2Ecom%2F"+n+"&redirect_uri=http%3A%2F%2Ffreecodecamp%2Ecom%2Fmap";main.setMapShare(a),window.ga("send","event","FB_LINK","SHARE","Facebook map share"),window.location.href=i}),$.each($(".sr-only"),function(e,a){" Complete"===$(a).text()&&$(a).parents("p").addClass("manip-hidden")}),$.each($(".map-collapse"),function(e,a){$(a).find(".manip-hidden").length===$(a).find("p").length&&(i(a),$(a).prev("h3").addClass("faded"),$(a).prev("h2").addClass("faded"))});var v,g,C=localStorage.getItem("currentDashedName"),w=$("p.padded-ionic-icon a");!C&&$(".sr-only").length&&(w=$(".sr-only")),g=w.filter(function(){return C?$(this).attr("href").match(C):" Complete"===$(this).text()}),g.length&&(g=g[g.length-1],v=$(g).offset().top-380,$("html, body, .map-accordion").scrollTop(v)),String(window.location).match(/\/map$/gi)&&($("body>.flashMessage").find(".alert").css("display","none"),$(".map-fixed-header").css("top","50px"));var b=$("#map-filter"),k=$("#showAll");$("#nav-map-btn").on("click",c),$(".map-aside-action-collapse").on("click",s),$("#nav-wiki-btn").on("click",l),$(".wiki-aside-action-collapse").on("click",r),$("#accordion").on("show.bs.collapse",function(e){a(e.target),$("a[data-toggle=collapse]").length===$(".fa-caret-down").length&&(k.text("折叠所有课程内容"),k.addClass("active"))}).on("hide.bs.collapse",function(e){t(e.target),$("a[data-toggle=collapse]").length===$(".fa-caret-right").length&&(k.text("展开所有课程内容"),k.removeClass("active"))}),k.on("click",function(){var e=k.hasClass("active");return e?($.each($(".map-collapse.in"),function(e,a){i(a)}),k.text("展开所有课程内容"),k.removeClass("active")):($.each($('.map-collapse:not(".in")'),function(e,a){n(a)}),k.text("折叠所有课程内容"),k.addClass("active"))}),b.on("keyup",function(){if(b.val().length>0){var e=new RegExp(b.val().replace(/ /g,"."),"i");$(".challenge-title").each(function(a,t){e.test($(t).attr("name"))?(n($(t).closest(".chapterBlock")),n($(t).closest(".certBlock")),$(t).removeClass("hidden")):$(t).addClass("hidden")}),$.each($(".chapterBlock"),function(e,a){$(a).find(".hidden").length===$(a).find("p").length?($(a).addClass("hidden"),$(a).prev("h3").addClass("hidden")):($(a).removeClass("hidden"),$(a).prev("h3").removeClass("hidden"))}),$.each($(".certBlock"),function(e,a){$(a).children("#nested").children("h3.hidden").length===$(a).children("#nested").children("h3").length?$(a).prev("h2").addClass("hidden"):$(a).prev("h2").removeClass("hidden")}),b.next().children().hasClass("fa-search")&&(b.next().children().removeClass("fa-search").addClass("fa-times"),b.next().addClass("filled"),$("html, body, .map-accordion").scrollTop(0))}else h();$.find(".certBlock").length===$(".map-accordion").children(".hidden").length?$("#noneFound").show():$("#noneFound").hide()}),b.focus(),$(".map-buttons .input-group-addon").on("click",h),b.on("keydown",function(e){27===e.keyCode&&(e.preventDefault(),h())}),window.Mousetrap.bind("esc",h),window.Mousetrap.bind("g m",c)});